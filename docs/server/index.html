<!DOCTYPE html>
<html lang="en">
  <head>
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-68258529-4"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "UA-68258529-4");
    </script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="Description"
      content="LowKey Media Server is a companion app for batch processing, AI tagging, transcription, and media ingestion."
    />
    <meta property="og:url" content="https://lowkeyviewer.com/server" />
    <meta property="og:type" content="product" />
    <meta property="og:title" content="LowKey Media Server" />
    <meta
      property="og:description"
      content="A companion server for batch processing, AI tagging, transcription, and media ingestion."
    />
    <meta
      property="og:image"
      content="https://lowkeyviewer.com/screenshot.jpg"
    />
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
    <link rel="icon" href="../favicon.ico" type="image/x-icon" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../index.css" />
    <title>LowKey Media Server - Documentation</title>
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Lowkey Media Server",
        "operatingSystem": "Windows 10, Linux",
        "applicationCategory": "MultimediaApplication",
        "offers": {
          "@type": "Offer",
          "price": "0"
        }
      }
    </script>
  </head>
  <body>
    <header>
      <nav class="tab-nav">
        <a href="../" class="tab-link">
          <img src="../logo.png" alt="Media Viewer" class="tab-icon" />
          <span>Media Viewer</span>
        </a>
        <a href="./" class="tab-link active">
          <img src="../server-icon.png" alt="Media Server" class="tab-icon" />
          <span>Media Server</span>
        </a>
      </nav>
    </header>

    <section class="hero">
      <img src="../server-icon.png" class="logo" alt="Lowkey Media Server Logo" />
      <h1>Lowkey Media Server</h1>
      <p class="subTitle">
        A companion server for batch processing, AI tagging, transcription, and media ingestion.
      </p>
      <p class="info">
        Works on <span class="os">Windows</span> and <span class="os">Linux</span>
      </p>
      <p class="info status-alpha">Alpha Release</p>
      <p class="buttonArea">
        <a id="serverDownloadButton" class="buyButton" href="#">Download | Free</a>
      </p>
      <p class="version">Version 1.0.0</p>
      <div class="header-links">
        <a href="https://github.com/SteveCastle/loki/blob/master/LICENSE" class="license-link">
          <img src="../mit.svg" alt="MIT License" />
        </a>
        <a href="https://github.com/SteveCastle/loki/tree/master/media-server" class="github-link">
          <img src="../GitHub-Mark-Light-32px.png" alt="GitHub" />
        </a>
      </div>
    </section>

    <div class="content-wrapper">
      <nav class="toc">
        <h2>Table of Contents</h2>
        <ul>
          <li><a href="#overview">Overview</a></li>
          <li><a href="#getting-started">Getting Started</a>
            <ul>
              <li><a href="#installation">Installation</a></li>
              <li><a href="#initial-setup">Initial Setup</a></li>
              <li><a href="#dependencies">Installing Dependencies</a></li>
              <li><a href="#web-ui">Web Interface</a></li>
              <li><a href="#browser-extension">Browser Extension</a></li>
            </ul>
          </li>
          <li><a href="#job-queue">Job Queue</a>
            <ul>
              <li><a href="#creating-jobs">Creating Jobs</a></li>
              <li><a href="#monitoring">Monitoring Progress</a></li>
              <li><a href="#job-management">Job Management</a></li>
            </ul>
          </li>
          <li><a href="#ingestion">Media Ingestion</a>
            <ul>
              <li><a href="#local-ingest">Local Directories</a></li>
              <li><a href="#youtube">YouTube Downloads</a></li>
              <li><a href="#gallery">Gallery Downloads</a></li>
            </ul>
          </li>
          <li><a href="#ai-features">AI & ML Features</a>
            <ul>
              <li><a href="#autotag">Auto-Tagging (ONNX)</a></li>
              <li><a href="#llm-vision">LLM Vision Descriptions</a></li>
              <li><a href="#transcription">Transcription</a></li>
            </ul>
          </li>
          <li><a href="#media-browser">Media Browser</a>
            <ul>
              <li><a href="#browse">Browsing & Search</a></li>
              <li><a href="#file-serving">File Serving</a></li>
            </ul>
          </li>
          <li><a href="#swipe-app">Swipe App</a></li>
          <li><a href="#tasks">Available Tasks</a></li>
          <li><a href="#config">Configuration</a></li>
          <li><a href="#api">API Reference</a></li>
        </ul>
      </nav>

      <main>
      <section id="overview">
        <h2>Overview</h2>
        <p>
          Lowkey Media Server is a companion application for the Lowkey Media Viewer that manages long-running offline tasks.
          Built in Go, it runs as an HTTP server on port 8090.
        </p>
        <ul>
          <li>Job queue with persistence and real-time status updates</li>
          <li>Media ingestion from local directories, YouTube, and gallery sites</li>
          <li>AI-powered auto-tagging using ONNX models</li>
          <li>LLM vision integration for image descriptions</li>
          <li>Video transcription with Faster Whisper</li>
          <li>Browser extensions for Chrome and Firefox</li>
          <li>Web-based media gallery and search</li>
        </ul>
      </section>

      <section id="getting-started">
        <h2>Getting Started</h2>

        <h3 id="installation">Installation</h3>
        <p>
          Download and run the Media Server executable. On Windows, it runs in the system tray for easy access.
          On Linux, run the binary from the command line.
        </p>

        <h3 id="initial-setup">Initial Setup</h3>
        <p>
          On first launch, you'll be prompted to create an initial user account. This account is used to authenticate
          with the web interface and API.
        </p>
        <div class="placeholder-video">Initial Setup Demo Video</div>

        <h3 id="dependencies">Installing Dependencies</h3>
        <p>
          The Media Server uses external tools for media processing. On the setup page, you can download and install
          the required dependencies with a single click. Dependencies are extracted on demand when a task requires them.
        </p>
        <p>Dependencies are downloaded to:</p>
        <div class="code-block">
          <code>Windows: %ProgramData%\Lowkey Media Server\tmp\</code><br>
          <code>Linux: /var/tmp/lowkeymediaserver/</code>
        </div>
        <p>Available dependencies include:</p>
        <ul>
          <li><strong>ffmpeg / ffprobe</strong> - Media processing and conversion</li>
          <li><strong>yt-dlp</strong> - Video downloading from YouTube and other sites</li>
          <li><strong>gallery-dl</strong> - Image gallery downloading</li>
          <li><strong>faster-whisper</strong> - Video transcription</li>
          <li><strong>ONNX Runtime</strong> - AI model inference for auto-tagging</li>
        </ul>
        <div class="placeholder-video">Dependency Setup Demo Video</div>

        <h3 id="web-ui">Web Interface</h3>
        <p>
          Access the web interface at <code>http://localhost:8090</code>.
          The home page shows the job queue with all running and completed jobs.
        </p>
        <div class="placeholder-video">Web UI Demo Video</div>

        <h3 id="browser-extension">Browser Extension</h3>
        <p>
          Install the browser extension for Chrome or Firefox to quickly create jobs from any webpage.
        </p>
        <ul>
          <li><strong>Chrome</strong>: Load unpacked from <code>chrome-extension/</code> folder</li>
          <li><strong>Firefox</strong>: Load from <code>firefox-extension/</code> folder</li>
        </ul>
        <p>Features:</p>
        <ul>
          <li>One-click task creation with current page URL</li>
          <li>Command selection dropdown</li>
          <li>Custom arguments support</li>
          <li>Real-time job status updates</li>
        </ul>
        <div class="placeholder-video">Browser Extension Demo Video</div>
      </section>

      <section id="job-queue">
        <h2>Job Queue</h2>
        <p>
          The job queue manages all processing tasks with persistence and real-time updates via Server-Sent Events (SSE).
        </p>

        <h3 id="creating-jobs">Creating Jobs</h3>
        <p>Create jobs through the web interface, browser extension, or API. Each job specifies:</p>
        <ul>
          <li>Task type (ingest, autotag, metadata, etc.)</li>
          <li>Input source (URL, file path, or directory)</li>
          <li>Optional follow-up tasks</li>
        </ul>
        <div class="placeholder-video">Job Creation Demo Video</div>

        <h3 id="monitoring">Monitoring Progress</h3>
        <p>
          Jobs display real-time progress with live output streaming. Job states include:
        </p>
        <ul>
          <li><span class="status pending">Pending</span> - Waiting to start</li>
          <li><span class="status in-progress">In Progress</span> - Currently running</li>
          <li><span class="status completed">Completed</span> - Finished successfully</li>
          <li><span class="status cancelled">Cancelled</span> - Stopped by user</li>
          <li><span class="status error">Error</span> - Failed with error</li>
        </ul>

        <h3 id="job-management">Job Management</h3>
        <p>Manage jobs with these actions:</p>
        <ul>
          <li><strong>Cancel</strong> - Stop a running job</li>
          <li><strong>Copy</strong> - Duplicate a job configuration</li>
          <li><strong>Remove</strong> - Delete a job from the queue</li>
          <li><strong>Clear</strong> - Remove all non-running jobs</li>
        </ul>
      </section>

      <section id="ingestion">
        <h2>Media Ingestion</h2>
        <p>
          The ingest task scans and adds media to the database from multiple sources with optional follow-up processing.
        </p>

        <h3 id="local-ingest">Local Directories</h3>
        <p>
          Scan local directories to add media files to the database. Supports recursive scanning for nested folders.
        </p>
        <div class="placeholder-video">Local Ingest Demo Video</div>

        <h3 id="youtube">YouTube Downloads</h3>
        <p>
          Download videos from YouTube and other sites using the bundled yt-dlp tool.
          Videos are automatically added to the database after download.
        </p>
        <div class="placeholder-video">YouTube Download Demo Video</div>

        <h3 id="gallery">Gallery Downloads</h3>
        <p>
          Download media from gallery sites using gallery-dl. Supports hundreds of sites including:
        </p>
        <ul>
          <li>Twitter/X, Instagram, Reddit</li>
          <li>DeviantArt, ArtStation, Pixiv</li>
          <li>Tumblr, Flickr, and many more</li>
        </ul>
        <div class="placeholder-video">Gallery Download Demo Video</div>
      </section>

      <section id="ai-features">
        <h2>AI & ML Features</h2>

        <h3 id="autotag">Auto-Tagging (ONNX)</h3>
        <p>
          Automatically tag images using ML models (WD Tagger). Configure thresholds for general and character tags.
        </p>
        <ul>
          <li>Batch processing of entire directories</li>
          <li>Configurable confidence thresholds</li>
          <li>Tags organized by category (Suggested, Character, etc.)</li>
        </ul>
        <div class="placeholder-video">Auto-Tagging Demo Video</div>

        <h3 id="llm-vision">LLM Vision Descriptions</h3>
        <p>
          Generate image descriptions using Ollama with vision models (llama3.2-vision, etc.).
          Customize prompts for different use cases.
        </p>
        <div class="placeholder-video">LLM Description Demo Video</div>

        <h3 id="transcription">Transcription</h3>
        <p>
          Generate transcripts for videos using Faster Whisper. Transcripts are saved as VTT files
          and can be viewed in the Media Viewer.
        </p>
        <div class="placeholder-video">Transcription Demo Video</div>
      </section>

      <section id="media-browser">
        <h2>Media Browser</h2>

        <h3 id="browse">Browsing & Search</h3>
        <p>
          Browse your media collection through the web interface at <code>/media</code>.
          Full-text search across filenames, descriptions, and tags.
        </p>
        <div class="placeholder-video">Media Browser Demo Video</div>

        <h3 id="file-serving">File Serving</h3>
        <p>
          Stream media files directly from the server with caching headers for performance.
          Access files at <code>/media/file?path=...</code>
        </p>
      </section>

      <section id="swipe-app">
        <h2>Swipe App</h2>
        <p>
          The Swipe App is a progressive web app (PWA) that provides a TikTok-like experience for browsing your media database.
          Install it on your smartphone to swipe through your collection with a mobile-optimized interface.
        </p>
        <ul>
          <li><strong>Installable PWA</strong> - Add to your home screen for a native app experience</li>
          <li><strong>Swipe Navigation</strong> - Swipe up/down to browse through media</li>
          <li><strong>Mobile Optimized</strong> - Designed for touch and vertical video viewing</li>
          <li><strong>Tag & Filter</strong> - Browse by tags and filter your collection</li>
        </ul>
        <p>
          Access the Swipe App at <code>http://[server-ip]:8090/swipe</code> on your mobile device.
        </p>
        <div class="placeholder-video">Swipe App Demo Video</div>
      </section>

      <section id="tasks">
        <h2>Available Tasks</h2>
        <table class="task-table">
          <tr><th>Task ID</th><th>Name</th><th>Description</th></tr>
          <tr><td><code>ingest</code></td><td>Ingest Media</td><td>Scan directories and add files to database</td></tr>
          <tr><td><code>metadata</code></td><td>Generate Metadata</td><td>Generate descriptions, transcripts, hashes</td></tr>
          <tr><td><code>autotag</code></td><td>Auto Tag</td><td>ML-based automatic image tagging</td></tr>
          <tr><td><code>yt-dlp</code></td><td>yt-dlp</td><td>Download videos from YouTube, etc.</td></tr>
          <tr><td><code>gallery-dl</code></td><td>gallery-dl</td><td>Download media from gallery sites</td></tr>
          <tr><td><code>ffmpeg</code></td><td>ffmpeg</td><td>Process and convert media files</td></tr>
          <tr><td><code>move</code></td><td>Move Media</td><td>Move files and update database references</td></tr>
          <tr><td><code>remove</code></td><td>Remove Media</td><td>Remove entries from database</td></tr>
          <tr><td><code>cleanup</code></td><td>Cleanup</td><td>Remove orphaned database entries</td></tr>
          <tr><td><code>lora-dataset</code></td><td>LoRA Dataset</td><td>Generate datasets for ML training</td></tr>
        </table>
      </section>

      <section id="config">
        <h2>Configuration</h2>
        <p>Configure the server through the web interface at <code>/config</code> or edit the config file directly:</p>
        <div class="code-block">
          <code>Windows: %APPDATA%\Lowkey Media Viewer\config.json</code><br>
          <code>Linux: ~/.config/lowkeymediaviewer/config.json</code>
        </div>
        <h4>Configuration Options</h4>
        <ul>
          <li><strong>dbPath</strong> - Path to the SQLite database</li>
          <li><strong>ollamaBaseUrl</strong> - Ollama server URL (default: http://localhost:11434)</li>
          <li><strong>ollamaModel</strong> - Vision model for descriptions</li>
          <li><strong>fasterWhisperPath</strong> - Path to Faster Whisper executable</li>
          <li><strong>onnxTagger</strong> - ONNX model configuration for auto-tagging</li>
        </ul>
      </section>

      <section id="api">
        <h2>API Reference</h2>
        <h4>Job Management</h4>
        <table class="api-table">
          <tr><th>Method</th><th>Endpoint</th><th>Description</th></tr>
          <tr><td>POST</td><td><code>/create</code></td><td>Create a new job</td></tr>
          <tr><td>GET</td><td><code>/job/{id}</code></td><td>View job details</td></tr>
          <tr><td>POST</td><td><code>/job/{id}/cancel</code></td><td>Cancel a running job</td></tr>
          <tr><td>POST</td><td><code>/job/{id}/copy</code></td><td>Copy job configuration</td></tr>
          <tr><td>POST</td><td><code>/job/{id}/remove</code></td><td>Remove a job</td></tr>
          <tr><td>POST</td><td><code>/jobs/clear</code></td><td>Clear non-running jobs</td></tr>
        </table>
        <h4>Media Operations</h4>
        <table class="api-table">
          <tr><th>Method</th><th>Endpoint</th><th>Description</th></tr>
          <tr><td>GET</td><td><code>/media</code></td><td>Media gallery page</td></tr>
          <tr><td>GET</td><td><code>/media/api</code></td><td>Media JSON API with search</td></tr>
          <tr><td>GET</td><td><code>/media/file</code></td><td>Serve media files</td></tr>
        </table>
        <h4>System</h4>
        <table class="api-table">
          <tr><th>Method</th><th>Endpoint</th><th>Description</th></tr>
          <tr><td>GET</td><td><code>/health</code></td><td>Server health and stats</td></tr>
          <tr><td>GET</td><td><code>/stream</code></td><td>SSE stream for real-time updates</td></tr>
          <tr><td>GET</td><td><code>/config</code></td><td>Configuration page</td></tr>
          <tr><td>POST</td><td><code>/config</code></td><td>Update configuration</td></tr>
        </table>
      </section>

      <section>
        <div class="divider"></div>
        <h2>Contact & Support</h2>
        <p>
          The Media Server is in alpha. Report issues and request features on GitHub or via email.
        </p>
        <ul>
          <li><a href="mailto:help@lowkeyviewer.com">Help Requests: help@lowkeyviewer.com</a></li>
          <li><a href="mailto:features@lowkeyviewer.com">Feature Requests: features@lowkeyviewer.com</a></li>
          <li><a href="https://github.com/SteveCastle/loki/issues">GitHub Issues</a></li>
        </ul>
      </section>
      </main>
    </div>

    <script>
      // Smooth scroll for TOC links
      document.querySelectorAll('.toc a').forEach(link => {
        link.addEventListener('click', (e) => {
          const href = link.getAttribute('href');
          if (href.startsWith('#')) {
            e.preventDefault();
            const target = document.getElementById(href.slice(1));
            if (target) {
              history.pushState(null, '', href);
              target.scrollIntoView({ behavior: 'smooth' });
            }
          }
        });
      });
    </script>
  </body>
</html>
